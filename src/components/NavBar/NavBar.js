import { useEffect, useRef, useState, useContext } from "react";

import { Container, Nav, Navbar } from "react-bootstrap";

import { CgMenuRight } from "react-icons/cg";

import { Link } from "react-scroll";

import FeatureBtn from "../FeatureBtn/FeatureBtn";

import { ThemeContext } from "../../App";

import { useTranslation } from "react-i18next";

const NavBar = () => {
  const { theme } = useContext(ThemeContext);

  const { t } = useTranslation("translation");

  const [bgColorSolid, setbgColorSolid] = useState("");

  const [expanded, setExpanded] = useState(false);

  let navBar = useRef();

  // scroll event handler
  useEffect(() => {
    const windowScrollHandler = () => {
      if (window.scrollY >= navBar.current.clientHeight) {
        setbgColorSolid("navbar--bgColorSolid");
      } else {
        setbgColorSolid("");
      }
    };

    window.addEventListener("scroll", windowScrollHandler);

    return () => {
      window.removeEventListener("scroll", windowScrollHandler);
    };
  }, []);

  // expend menu handler
  const onclickLinkHandler = () => {
    setExpanded(false);
  };

  const onClickToggleBtnHandler = () => {
    setExpanded(!expanded);
  };

  return (
    <Navbar
      fixed="top"
      expand="md"
      expanded={expanded}
      className={`navbar ${theme} py-0 ${bgColorSolid}`}
      ref={navBar}
    >
      <Container className="px-0">
        <Navbar.Brand href="#home" className="navbar__brand">
          <svg
            className="img-fluid"
            width="132"
            height="80"
            viewBox="0 0 132 80"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M22.696 19.104L24.712 21.424L14.536 28.64V27.376L24.712 34.528L22.696 36.88L12.36 29.36V26.656L22.696 19.104ZM42.6202 38V28.976C42.6202 27.6427 42.3002 26.6347 41.6602 25.952C41.0309 25.2587 40.1776 24.912 39.1003 24.912C38.2469 24.912 37.5002 25.1467 36.8602 25.616C36.2309 26.0747 35.7402 26.752 35.3882 27.648C35.0469 28.5333 34.8762 29.616 34.8762 30.896H33.7882C33.7882 29.008 34.0282 27.4187 34.5082 26.128C34.9989 24.8373 35.6976 23.8613 36.6042 23.2C37.5109 22.528 38.5989 22.192 39.8682 22.192C41.1056 22.192 42.1509 22.4693 43.0043 23.024C43.8683 23.5787 44.5243 24.368 44.9722 25.392C45.4203 26.4053 45.6443 27.6 45.6443 28.976V38H42.6202ZM31.8362 38V22.608H34.4762L34.8762 25.936V38H31.8362ZM58.934 38.416C58.0593 38.416 57.27 38.2507 56.566 37.92C55.862 37.5893 55.302 37.0933 54.886 36.432C54.4807 35.76 54.278 34.9173 54.278 33.904V18.416H57.302V33.808C57.302 35.2587 57.9793 35.984 59.334 35.984C59.75 35.984 60.1553 35.9413 60.55 35.856C60.9447 35.76 61.3927 35.6213 61.894 35.44L62.326 37.6C61.7607 37.8347 61.2007 38.0267 60.646 38.176C60.102 38.336 59.5313 38.416 58.934 38.416ZM51.926 24.672V22.608H61.862V24.672H51.926ZM74.4153 38.416C73.1566 38.416 71.9993 38.08 70.9433 37.408C69.8873 36.7253 69.0446 35.776 68.4153 34.56C67.7966 33.3333 67.4873 31.8933 67.4873 30.24C67.4873 28.5973 67.7913 27.1733 68.3993 25.968C69.0179 24.7627 69.8339 23.8347 70.8473 23.184C71.8606 22.5227 72.9859 22.192 74.2233 22.192C75.3539 22.192 76.3406 22.4693 77.1833 23.024C78.0259 23.568 78.6766 24.3627 79.1353 25.408C79.6046 26.4533 79.8393 27.728 79.8393 29.232H78.7833C78.7833 28.304 78.5966 27.52 78.2233 26.88C77.8499 26.2293 77.3646 25.7387 76.7673 25.408C76.1699 25.0773 75.5299 24.912 74.8473 24.912C74.0473 24.912 73.3219 25.1307 72.6713 25.568C72.0313 25.9947 71.5193 26.608 71.1353 27.408C70.7619 28.1973 70.5753 29.1413 70.5753 30.24C70.5753 31.3493 70.7619 32.3147 71.1353 33.136C71.5193 33.9467 72.0313 34.5707 72.6713 35.008C73.3219 35.4453 74.0419 35.664 74.8313 35.664C75.4819 35.664 76.1059 35.4933 76.7033 35.152C77.3113 34.8 77.8073 34.2987 78.1913 33.648C78.5859 32.9973 78.7833 32.224 78.7833 31.328H79.8393C79.8393 32.864 79.5939 34.16 79.1033 35.216C78.6233 36.272 77.9726 37.072 77.1513 37.616C76.3299 38.1493 75.4179 38.416 74.4153 38.416ZM79.3113 38L78.7833 34.304V16.128H81.8393V38H79.3113ZM89.2972 40.416L97.4092 14.416H100.513L92.3532 40.416H89.2972ZM107.897 36.88L105.897 34.528L116.025 27.376V28.64L105.897 21.424L107.897 19.104L118.233 26.656V29.36L107.897 36.88Z"
              fill="#fff"
            />
            <path
              d="M15.785 52.5025H16.771V57.2625H22.296V52.5025H23.2565V63H22.296V58.0955H16.771V63H15.785V52.5025ZM30.8961 63.187C30.1935 63.187 29.573 63.0085 29.0346 62.6515C28.502 62.2888 28.0826 61.793 27.7766 61.164C27.4706 60.5293 27.3176 59.8068 27.3176 58.9965C27.3176 58.1125 27.4678 57.3532 27.7681 56.7185C28.0741 56.0838 28.4935 55.5965 29.0261 55.2565C29.5645 54.9165 30.1878 54.7465 30.8961 54.7465C31.4911 54.7465 31.9955 54.8683 32.4091 55.112C32.8285 55.35 33.1656 55.6758 33.4206 56.0895C33.6756 56.5032 33.8541 56.9707 33.9561 57.492C34.0638 58.0133 34.1063 58.5517 34.0836 59.107H28.1251V58.427H33.4801L33.0891 58.682C33.1061 58.3137 33.0835 57.9482 33.0211 57.5855C32.9645 57.2172 32.854 56.88 32.6896 56.574C32.531 56.268 32.3071 56.0215 32.0181 55.8345C31.7291 55.6475 31.358 55.554 30.9046 55.554C30.3266 55.554 29.845 55.7042 29.4596 56.0045C29.0743 56.2992 28.7853 56.6845 28.5926 57.1605C28.4056 57.6308 28.3121 58.1352 28.3121 58.6735V59.09C28.3121 59.7077 28.4056 60.263 28.5926 60.756C28.7853 61.249 29.0715 61.64 29.4511 61.929C29.8365 62.218 30.3181 62.3625 30.8961 62.3625C31.4911 62.3625 31.9756 62.218 32.3496 61.929C32.7293 61.6343 32.956 61.2037 33.0296 60.637H34.0836C33.9986 61.1753 33.8088 61.6343 33.5141 62.014C33.2251 62.3937 32.8568 62.6855 32.4091 62.8895C31.9615 63.0878 31.4571 63.187 30.8961 63.187ZM38.1446 63V51.44H39.1306V63H38.1446ZM44.0535 63V51.44H45.0395V63H44.0535ZM52.7503 63.187C52.0306 63.187 51.396 63.0255 50.8463 62.7025C50.2966 62.3795 49.8631 61.9035 49.5458 61.2745C49.2341 60.6455 49.0783 59.8748 49.0783 58.9625C49.0783 58.0502 49.2341 57.2823 49.5458 56.659C49.8631 56.03 50.2966 55.554 50.8463 55.231C51.396 54.908 52.0306 54.7465 52.7503 54.7465C53.47 54.7465 54.1046 54.908 54.6543 55.231C55.204 55.554 55.6346 56.03 55.9463 56.659C56.258 57.2823 56.4138 58.0502 56.4138 58.9625C56.4138 59.8748 56.258 60.6455 55.9463 61.2745C55.6346 61.9035 55.204 62.3795 54.6543 62.7025C54.1046 63.0255 53.47 63.187 52.7503 63.187ZM52.7333 62.3285C53.3283 62.3285 53.8241 62.1897 54.2208 61.912C54.6175 61.6287 54.9121 61.2348 55.1048 60.7305C55.3031 60.2262 55.4023 59.6368 55.4023 58.9625C55.4023 57.9482 55.1841 57.1322 54.7478 56.5145C54.3171 55.8968 53.657 55.588 52.7673 55.588C52.1723 55.588 51.6765 55.7297 51.2798 56.013C50.8888 56.2907 50.5941 56.6845 50.3958 57.1945C50.2031 57.6988 50.1068 58.2882 50.1068 58.9625C50.1068 59.9712 50.3221 60.7843 50.7528 61.402C51.1891 62.0197 51.8493 62.3285 52.7333 62.3285ZM64.1849 52.5025H65.3069L68.1289 62.1245H67.7974L70.7384 53.7945H71.4099L74.2489 62.0905H73.9174L77.2834 52.5025H78.3714L74.6059 63H73.5689L70.9509 55.3925H71.2399L68.4944 63H67.4574L64.1849 52.5025ZM84.1067 63.187C83.387 63.187 82.7523 63.0255 82.2027 62.7025C81.653 62.3795 81.2195 61.9035 80.9022 61.2745C80.5905 60.6455 80.4347 59.8748 80.4347 58.9625C80.4347 58.0502 80.5905 57.2823 80.9022 56.659C81.2195 56.03 81.653 55.554 82.2027 55.231C82.7523 54.908 83.387 54.7465 84.1067 54.7465C84.8263 54.7465 85.461 54.908 86.0107 55.231C86.5603 55.554 86.991 56.03 87.3027 56.659C87.6143 57.2823 87.7702 58.0502 87.7702 58.9625C87.7702 59.8748 87.6143 60.6455 87.3027 61.2745C86.991 61.9035 86.5603 62.3795 86.0107 62.7025C85.461 63.0255 84.8263 63.187 84.1067 63.187ZM84.0897 62.3285C84.6847 62.3285 85.1805 62.1897 85.5772 61.912C85.9738 61.6287 86.2685 61.2348 86.4612 60.7305C86.6595 60.2262 86.7587 59.6368 86.7587 58.9625C86.7587 57.9482 86.5405 57.1322 86.1042 56.5145C85.6735 55.8968 85.0133 55.588 84.1237 55.588C83.5287 55.588 83.0328 55.7297 82.6362 56.013C82.2452 56.2907 81.9505 56.6845 81.7522 57.1945C81.5595 57.6988 81.4632 58.2882 81.4632 58.9625C81.4632 59.9712 81.6785 60.7843 82.1092 61.402C82.5455 62.0197 83.2057 62.3285 84.0897 62.3285ZM91.7929 63V54.925H92.7789V63H91.7929ZM92.4134 59.3025C92.4134 58.2938 92.5013 57.4552 92.6769 56.7865C92.8526 56.1178 93.1246 55.6163 93.4929 55.282C93.8613 54.9477 94.3316 54.7805 94.9039 54.7805C95.1023 54.7805 95.2836 54.7947 95.4479 54.823C95.6179 54.8513 95.7879 54.8967 95.9579 54.959L95.8474 55.9195C95.6831 55.8572 95.5018 55.8062 95.3034 55.7665C95.1051 55.7212 94.9323 55.6985 94.7849 55.6985C94.2806 55.6985 93.8811 55.8515 93.5864 56.1575C93.2974 56.4635 93.0906 56.8885 92.9659 57.4325C92.8413 57.9708 92.7789 58.5942 92.7789 59.3025H92.4134ZM99.0299 63V51.44H100.016V63H99.0299ZM107.778 63.187C107.137 63.187 106.545 63.0142 106.001 62.6685C105.463 62.3172 105.032 61.8242 104.709 61.1895C104.386 60.5548 104.225 59.804 104.225 58.937C104.225 58.07 104.383 57.3248 104.701 56.7015C105.024 56.0725 105.449 55.5908 105.976 55.2565C106.508 54.9165 107.089 54.7465 107.718 54.7465C108.302 54.7465 108.82 54.891 109.274 55.18C109.727 55.4633 110.081 55.8713 110.336 56.404C110.591 56.931 110.719 57.5657 110.719 58.308H110.268C110.268 57.713 110.152 57.2172 109.92 56.8205C109.693 56.4182 109.396 56.115 109.027 55.911C108.659 55.707 108.265 55.605 107.846 55.605C107.387 55.605 106.959 55.7382 106.562 56.0045C106.171 56.2708 105.854 56.6505 105.61 57.1435C105.372 57.6365 105.253 58.2343 105.253 58.937C105.253 59.6453 105.372 60.2517 105.61 60.756C105.848 61.2603 106.166 61.6457 106.562 61.912C106.959 62.1783 107.39 62.3115 107.854 62.3115C108.251 62.3115 108.633 62.2095 109.002 62.0055C109.37 61.8015 109.673 61.5012 109.911 61.1045C110.149 60.7022 110.268 60.2092 110.268 59.6255H110.719C110.719 60.3735 110.588 61.0138 110.328 61.5465C110.073 62.0792 109.721 62.4872 109.274 62.7705C108.832 63.0482 108.333 63.187 107.778 63.187ZM110.413 63L110.268 61.164V51.44H111.246V63H110.413ZM116.346 60.3735L116.202 52.6725H117.23L117.094 60.3735H116.346ZM116.712 63.153C116.485 63.153 116.295 63.0793 116.142 62.932C115.995 62.7847 115.921 62.6062 115.921 62.3965C115.921 62.1868 115.995 62.0055 116.142 61.8525C116.295 61.6938 116.485 61.6145 116.712 61.6145C116.938 61.6145 117.128 61.6938 117.281 61.8525C117.44 62.0055 117.519 62.1868 117.519 62.3965C117.519 62.6062 117.44 62.7847 117.281 62.932C117.128 63.0793 116.938 63.153 116.712 63.153Z"
              fill="#FFF8F8"
            />
          </svg>
        </Navbar.Brand>

        <Navbar.Toggle
          aria-controls="basic-navbar-nav"
          className="navbar__button"
          onClick={onClickToggleBtnHandler}
        >
          <CgMenuRight className="navbar__icon" />
        </Navbar.Toggle>

        <Navbar.Collapse id="basic-navbar-nav">
          <Nav className="w-100 justify-content-end align-items-md-center">
            <Link
              activeClass="active"
              spy
              to="about"
              onClick={onclickLinkHandler}
              className="navbar__link"
            >
              {t("navbar.about")}
            </Link>

            <Link
              activeClass="active"
              spy
              to="skills"
              onClick={onclickLinkHandler}
              className="navbar__link"
            >
              {t("navbar.skills")}
            </Link>

            <Link
              activeClass="active"
              spy
              to="experiences"
              onClick={onclickLinkHandler}
              className="navbar__link"
            >
              {t("navbar.projects")}
            </Link>

            <Link
              activeClass="active"
              spy
              hashSpy={true}
              to="contact"
              onClick={onclickLinkHandler}
              className="navbar__link"
            >
              {t("navbar.contact")}
            </Link>

            <FeatureBtn onclickLinkHandler={onclickLinkHandler} />
          </Nav>
        </Navbar.Collapse>
      </Container>
    </Navbar>
  );
};

export default NavBar;
